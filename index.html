<html>
<head>
<style>
button{font-size: 1.3em;}
.show-wrap{ display: inline-block;margin: 0 5px}
.show{
  height: 400px; width: 400px; background-color: lightgoldenrodyellow;
  text-align: center; line-height: 400px; font-size: 30px;position: relative;
}
.tolib{
  position: absolute; top: 5px; right: 5px;
}
</style>
</head>
<body>
<div style="text-align:center;position:relative;">
<button id='fast'>fast</button>
<button id='medium'>medium</button>
<button id='slow'>slow</button>
<a class="tolib" href="https://github.com/hezedu/hold-back">github</a>
</div>
<hr/>
<div style="text-align:center;">
  <div class='show-wrap'>
    <h2>Pool</h2>
  <div id="show" class='show'></div>
  </div><div class='show-wrap'>
    <h2>Un Pool</h2>
  <div id="show-un-pool" class='show'></div>
  </div>
  <hr/>
  <div id="detail"></div>
</div>
<script src='/hold-back/index.js'></script>
<script>
(function(){
  var pool = new HoldBack();

  function $id(id){
    return document.getElementById(id)
  }
  var fast = $id('fast')
  var slow = $id('slow')
  var medium = $id('medium')
  var show = $id('show')
  var showUnPool = $id('show-un-pool')
  var detail = $id('detail')
  var active = {style: {}};
  function showDetail(){
    var _pool = pool.pool;
    var text = ''
    for(var i in _pool){
      text += i + ' is Requesting' + '<br/>';
    }
    detail.innerHTML = text
  }
  function listenG(m, id){
    return function(){
      active.style.backgroundColor = '';
      this.style.backgroundColor = 'dodgerblue';
      active = this;
      pool.start(id);
      showDetail()
      setTimeout(function(){
        showUnPool.innerHTML = id + ' : ' + m + 'ms';
        if(pool.end(id)){
          show.innerHTML = id + ' : ' + m + 'ms';
        }
        showDetail()
      }, m)
    }
  }

  fast.addEventListener('click', listenG(100, 'fast'))
  medium.addEventListener('click', listenG(1000, 'medium'))
  slow.addEventListener('click', listenG(3000, 'slow'))
  fast.click();
})()

</script>
</body>
</html>
